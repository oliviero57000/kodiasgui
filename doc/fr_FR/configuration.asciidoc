=== Configuration des écrans

Chaque Kodi affichent plusieurs écrans, chacun de ces écrans se configure séparément. Cette configuration se fait en utilisant des "Design" créés sur Jeedom.
On va ensuite lier ces design aux pages du Kodi que l'on souhaite afficher. 

Chaque page propose 2 modes d'affichages : 

* Le mode "Standard" : 

Chaque controle est prédisposé dans la page. Ici le positionement des equipements dans le design influra sur l'ordre dans lequel les controles seront affichés.

* Le mode "Plan" : 

Chaque controle est disposé dans la page selon le positionement de l'équipement correspondant dans le design. L'image de fond du design sera aussi affichée en mode plan. 

image::../images/install8.png[] 

==== Accueil

La page d'accueil à pour but de proposer l'ensemble des commandes et informations utiles dans la piéce où se trouve le Kodi. Cette page accepte donc différents types d'équipements.

==== Eclairage

La page de gestion des éclairages a pour but de rassembler l'ensemble des commandes d'éclairage. Le menu de cette page est configurable.

==== Chauffage

La page de gestion du chauffage a pour but de rassembler l'ensemble des informations sur la température et l'hygrometrie ainsi que les commandes de thermostat. Le menu de cette page est configurable.

==== Sécurité

La page de gestion de la sécurité rassemble l'ensemble des informations sur la detection de présence et d'ouverture, l'accès aux caméras et les commandes des differents accès (portail, serrure , store électrique). Ainsi que la gestion de l'alarme. Le menu de cette page est configurable.

==== Energie

La page de gestion des energies rassemble l'ensemble des informations sur les consommations d'électricité , d'eau et de gaz. Elle rassemble aussi les commandes liées à ces energie (pilotage de relais ou d'électrovanne)

==== Equipement

Les équipements regroupent tous les objets connectés hors des catégories précédentes. Par exemple, un lave linge , une montre, une TV , une plante ...  Cette page rassemble l'ensemble de ces equipements.

==== Infos

La page Infos est une version modifiée de la page "Météo" de kodi , en plus de la météo configurée sur kodi cette pages rassemble différentes informations remontées par jeedom. Par exemple l'etat du traffic, l'agenda , des d'alertes ou d'information.


=== Exemple rapide de configuration

Voici un exemple simple de configuration d'écran pour comprendre le principe. 
Dans Jeedom créé un Design "Kodi Accueil" 

Configurez la taille du design pour correspondre au mode plein ecran de votre kodi
Choisissez une image de fond.

image::../images/install9.png[] 

Ajoutez un equipement dans votre design qui va correspondre à un éclairage dans notre exemple. Vous pouvez utiliser n'importe quel type d'équipement provenant de n'importe quel plugin , y compris un virtuel.

[Seule condition] cet equipement doit avoir au minimum les commandes "ETAT , STATUS ou VALUE" et "ON ou ALLUMER" et "OFF ou ETEINDRE" (indifféremment minuscule ou majuscule)

Sauvegardez votre design, puis allez sur la configuration de votre Kodi. Dans l'onglet "Accueil" selectionner le design que vous avez créé.
L'equipement doit alors s'afficher dans la liste en dessous.

image::../images/install10.png[] 

Donnez lui un Alias , ce sera le nom  affiché sur Kodi pour cet objet. Et dans la box +Type+ entrez "Lumiere"
Sauvegardez votre equipement et lancez votre Kodi. Celui-ci doit afficher une commande d'eclairage avec le nom de votre Alias. Si les commandes de votre equipement sont fonctionelles, l'icone doit afficher l'etat allumer ou eteint de la lampe.
Lorsque vous cliquez sur cet icone (partie gauche de la commande) celle-ci doit alors basculer Allumer/Eteinte. En cliquant sur la partie droite du contrôle (là où l'alias est affiché) un popup s'ouvre pour proposer les différentes commandes possible. 

Si vous selectionnez ensuite le mode plan dans le menu, l'image que vous avez choisie dans le design doit alors s'afficher et les différents equipements s'affiche également (pas sur l'accueil dans la BETA, essayez la même configuration sur la page eclairage)



=== Configuration des contrôles 
 
Chaque écran gére certain type de contrôle, si vous ajouter un contrôle non géré sur une page, celui-ci sera simplement ignoré. Si un même equipement est ajouté sur plusieurs pages différentes attention à bien définir partout le même +Alias+ et le même +Type+
Ces parametres ne sont pas stockés dans le plugin mais dans l'équipement lui-même. Si vous retirez un équipement d'un design et le remettez plus tard, il aura garder sa configuration.
Le +Type+ indique au plugin comment gérer un equipement, mais il ne s'interfacera correctement que si les commandes pré-requises existent dans cet équipement.
Voici la liste des contrôles gérés dans cette version ainsi que leur parametrage par catégorie :

* Les caractéres accentués sont acceptés dans l'Alias mais non acceptés dans le Type
* Les commandes sont affichées ici en majuscule mais leur format n'importe peu.

==== Eclairage

Les contrôles de type éclairage s'affichent dans l'écran d'accueil et dans la page dédiée à l'éclairage.

===== Type : Lumiere

Eclairage simple on/off.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|ETAT , STATUS , VALUE	 	|(infos) |Retour d'état 0 = eteint,  1 = allumé
|ALLUMER , ON				|(cmd)	 |Allumer la lampe
|ETEINDRE , OFF				|(cmd)	 |Eteindre la lampe
|MODE						|(infos) |Mode de fonctionnement actuel de la lumiere
|MODE_xxxx					|(cmd)	 |Activer le mode xxxx
|=======

Le mode est une fonctionalité optionelle de la lampe, par exemple activer un mode "Manuel" / "Automatique" (detection de présence) sur un equipement du plugin Gestion des Lumieres, ou un effet "CYCLE", "FLASH" disponible sur les lampes de couleurs.

[BETA NOTES] Gérer le switch sans retour d'etat disponible. 

===== Type : LumiereDimmer

Eclairage à intensitée reglable (Dimmer).

[width="85%"]
|=======
|Commandes supportées | Type | Description
|ETAT , STATUS , VALUE	 	|(infos) |Retour d'état 0 = eteint,  1 = allumé
|ALLUMER , ON				|(cmd)	 |Allumer la lampe
|ETEINDRE , OFF				|(cmd)	 |Eteindre la lampe
|INTENSITY					|(cmd)	 |Intensité à définir en % (0 - 100)
|MODE						|(infos) |Mode de fonctionnement actuel de la lumiere
|MODE_xxxx					|(cmd)	 |Activer le mode xxxx
|=======

Le "mode" est une fonctionalité optionelle de la lampe, par exemple pour activer un mode "Manuel" / "Automatique" (detection de présence) sur un equipement du plugin Gestion des Lumieres, ou un effet "CYCLE", "FLASH" disponible sur les lampes de couleurs.

[BETA NOTES] Le reglage de l'intensité ne fonctionne pas encore.

===== Type : LumiereRGB

Eclairage à couleur variale (RGB).

[width="85%"]
|=======
|Commandes supportées | Type | Description
|ETAT , STATUS , VALUE	 	|(infos) |Retour d'état 0 = eteint,  1 = allumé
|ALLUMER , ON				|(cmd)	 |Allumer la lampe
|ETEINDRE , OFF				|(cmd)	 |Eteindre la lampe
|COLORRED					|(infos)	 |Valeur pour la composante rouge (0 - 255)
|COLORGREEN					|(infos)	 |Valeur pour la composante verte (0 - 255)
|COLORBLUE					|(infos)	 |Valeur pour la composante bleue (0 - 255)
|MODE						|(infos) |Mode de fonctionnement actuel de la lumiere
|MODE_xxxx					|(cmd)	 |Activer le mode xxxx
|=======

==== Infos

Les controle de type infos s'affichent dans l'écran d'accueil et dans la page dédiée aux infos. Il sont aussi utilisés pour transmettre des alertes de jeedom sur n'importe quel ecran de kodi y compris par dessus une video.

===== Type : Info

Message simple.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|STATUS , VALUE			 	|(infos) |Message d'information à afficher
|=======

[BETA NOTES] En test. Ajouter un logo ou une categorie ?

===== Type : Alerte

Message important à afficher sur l'accueil ou ecran information. Avec popup d'annonce sur les autres écrans. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|STATUS , VALUE			 	|(infos) |Message d'information à afficher
|=======

[BETA NOTES] En test. Ajouter un logo ou une categorie ?


===== Type : Popup

Message important à afficher en popup sur tout ecran ouvert de kodi. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|STATUS , VALUE			 	|(infos) |Message à afficher 
|=======

[BETA NOTES] Ne fonctionne pas encore. 

===== Type : Presence

Etat de detection de présence dans une piece. Un seul controle presence est géré sur la page d'accueil, plusieurs peuvent être gérés sur la page sécurité. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|MOVE, STATUS , VALUE			 	|(infos) |Etat du detecteur 0 = il y à personne , 1 = il y à quelqu'un , n > 1 = il y à n personnes 
|=======

[BETA NOTES] Affichage sur l'accueil uniquement. 

===== Type : Innondation

Etat de detection d'innondation dans une piece. Sur la page d'accueil l'alarme s'affiche quelquesoit la piece concernée.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|FLOOD, STATUS , VALUE			 	|(infos) |Etat du detecteur 0 = pas d'innondation , 1 = innondation detectée 
|=======

[BETA NOTES] Affichage sur l'accueil uniquement. 

===== Type : Feu

Etat de detection d'incendie dans une piece. Sur la page d'accueil l'alarme s'affiche quelquesoit la piece concernée.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|FIRE, STATUS , VALUE			 	|(infos) |Etat du detecteur 0 = pas d'alarme , 1 = feu ou fumée detectée.
|=======

[BETA NOTES] Affichage sur l'accueil uniquement. 

===== Type : Luminosite

Luminosité dans une piece affichée en lumen.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|LUMEN, STATUS , VALUE			 	|(infos) |Luminositée mesurée en lumen.
|=======

[BETA NOTES] Affichage sur l'accueil uniquement. 

==== Chauffage

Les controle de type chauffage s'affichent dans l'écran d'accueil et dans la page dédiée au chauffage.

===== Type : Thermomètre

Température mesurée. Jusqu'à 4 températures peuvent être affichées sur la page d'accueil. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|TEMPéRATURE, STATUS , VALUE			 	|(infos) |Température à afficher en degrés celcius (valeur seule, pas de symbole °c)
|=======

[BETA NOTES] Ok sur accueil , En test sur la page chauffage. Affichage de l'historique prévu.

===== Type : Hygromètre

Hygrométrie mesurée. Jusqu'à 4 capteurs peuvent être affichées sur la page d'accueil. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|STATUS , VALUE			 	|(infos) |Hygrométrie à afficher en pourcentage  (valeur seule, pas de symbole % )
|=======

[BETA NOTES] Ok sur accueil , En test sur la page chauffage. Affichage de l'historique prévu.

===== Type : Thermostat

Contrôle de chauffage par thermostat pour une zone. Un seul Thermostat géré sur la page d'accueil, plusieurs zones sur la page chauffage.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|STATUT, STATUS , ETAT			 	|(infos) |Etat du chauffage. (Arrété , Chauffe ...)
|MODE							 	|(infos) |Mode de fonctionement du thermostat. (Confort , Manuel ...)
|CONSIGNE							|(infos) |Consigne de température à atteindre pour le mode encours en degres celcius
|ON									|(cmd) |Marche forcée du chauffage / Climatisation
|OFF								|(cmd) |Arret du chauffage / Climatisation
|=======

[BETA NOTES] Affichage ok, interaction en test. 


==== Energie

Les contrôles de type energie s'affichent dans l'écran d'accueil et dans la page dédiée au chauffage.

===== Type : Eau

Contrôle d'une électro-vanne et affichage d'information sur le débit et la consommation d'eau. Jusqu'à 2 contrôles peuvent être affichés sur la page d'accueil, plusieurs sur la page energie.

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|ETAT, STATUS , VALUE			 			|(infos) |Etat de l'electro-vanne 0 = Fermée , 1 = Ouvert
|DEBIT, FLOW							 	|(infos) |Debit en litre / heure
|COUNT, COMPTEUR						 	|(infos) |Compteur de debit en m3
|ON, OUVRIR								 	|(cmd) |Commande d'ouverture de la vanne
|OFF, FERMER							 	|(cmd) |Commande de fermeture de la vanne
|=======

[BETA NOTES] Affichage en test. 


==== Equipements

Les contrôles de type equipement s'affichent dans l'écran d'accueil et dans la page dédiée.

===== Type : Equipment

Contrôle generique d'un equipement connecté. Le contrôle générique permet l'affichage d'informations paramétrables et l'execution de commandes simples. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|ETAT, STATUS , VALUE			 			|(infos) |Etat de l'equipement (texte)
|PARAM1									 	|(infos) |Valeur du parametre 1
|PARAM2									 	|(infos) |Valeur du parametre 2
|ON, START								 	|(cmd) |Commande de mise en marche
|OFF, STOP								 	|(cmd) |Commande d'arret
|=======

[BETA NOTES] Affichage seul en test.

===== Type : Frigo

Contrôle d'un réfrigérateur connecté. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|ETAT, STATUS , VALUE			 			|(infos) |Etat de l'equipement (texte)
|TEMPERATURE1							 	|(infos) |Température mesurée en zone 1
|TEMPERATURE2							 	|(infos) |Température mesurée en zone 2
|ON, START								 	|(cmd) |Commande de mise en marche
|OFF, STOP								 	|(cmd) |Commande d'arret
|=======

[BETA NOTES] Affichage seul en test.
 
===== Type : TV

Contrôle d'un téléviseur connecté. 

[width="85%"",options="header"]
|=======
|Commandes supportées | Type | Description
|ETAT, STATUS , VALUE			 			|(infos) |Etat de l'equipement (texte)
|PARAM1									 	|(infos) |Température mesurée en zone 1
|PARAM2									 	|(infos) |Température mesurée en zone 2
|ON, START								 	|(cmd) |Commande de mise en marche
|OFF, STOP								 	|(cmd) |Commande d'arret
|=======

[BETA NOTES] Affichage seul en test.


=== Contrôles non supportés

Le nombre de contrôle supportées va s'agrandir avec les nouvelles version de ce plugin. Je ne possede pas tout les plugins ni tous les types d'équipements existant sur Jeedom. Il m'est donc impossible de tout tester et prévoir.
Si un de vos equipements ne s'interface pas correctement avec ce plugin, voici la marche à suivre.

* Pour corriger immédiatement le problème , créez un virtuel qui va re-mapper les commandes de votre équipement vers des noms de commandes supportées par le plugin et utilisez ce virtuel dans votre design.  
* Sur le forum envoyez-moi les infos suivantes pour l'ajouter aux equipements gérés dans la prochaine version : La liste des commandes de l'équipement et leur signification. 

=== Menu personalisés

Dans les pages de chaque catégorie, le menu peut être personalisé. Pour ajouter des fonctions au menu, il suffit d'ajouter des Scenarios au design de la page.
Par exemple un scenario "Tout Allumer" peut être ajouter à la page "Eclairage" afin de creer une fonction qui allumera l'ensemble des éclairages du systeme.
Le nom du scenario sera utilisé pour définir le texte du bouton dans le menu.
Ce type de scenario ressemble à ceci :

image::../images/install11.png[]

